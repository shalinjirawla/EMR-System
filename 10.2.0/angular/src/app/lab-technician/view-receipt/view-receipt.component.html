<div class="receipt-wrapper" id="labReceiptToPrint">
  <!-- Header -->
  <header class="receipt-header">
    <div class="left">
      <div>
        <h1 class="hospital-name">{{ hospitalName }}</h1>
        <small class="meta-row">
          123 Medical Complex, Health Nagar, Mumbai-400001 • +91 9876543210 • GSTIN: 27ABCDE1234F1Z5
        </small>
      </div>
    </div>

    <div class="right">
      <h1 class="title">LAB TEST PAYMENT RECEIPT</h1>
      <div class="meta-row">
        <strong>No:</strong> {{ receiptDetail?.receiptNumber || labReceiptId }}
      </div>
      <div class="meta-row">
        <strong>Date:</strong>
        {{ receiptDetail?.paymentDate | date: 'dd/MM/yyyy' }}
      </div>
      <div class="meta-row">
        <strong>Status:</strong>
        <span class="badge ok">{{ receiptDetail?.status }}</span>
      </div>
    </div>
  </header>

  <!-- Patient Info -->
  <section class="info-block" *ngIf="receiptDetail">
    <h4 class="block-title">Patient Information</h4>
    <p><strong>Patient Name:</strong> {{ receiptDetail.patient?.fullName || 'N/A' }}</p>
    <p><strong>Payment Mode:</strong> {{ receiptDetail.paymentMethod || 'N/A' }}</p>
  </section>

  <!-- Payment Items Table -->
  <table class="bill-table" *ngIf="receiptDetail?.items?.length">
    <thead>
      <tr>
        <th>Description</th>
        <th class="text-right">Amount (₹)</th>
      </tr>
    </thead>
    <tbody>
      <ng-container *ngFor="let it of receiptDetail.items">
        <!-- Package -->
        <tr *ngIf="it.isPackage">
          <td>
            <strong>{{ it.packageName }}</strong>
            <ul class="package-items">
              <li *ngFor="let p of it.packageTests">- {{ p }}</li>
            </ul>
          </td>
          <td class="text-right">{{ it.packagePrice | number:'1.2-2' }}</td>
        </tr>
        <!-- Single Test -->
        <tr *ngIf="!it.isPackage">
          <td>{{ it.labReportTypeName }}</td>
          <td class="text-right">{{ it.labReportPrice | number:'1.2-2' }}</td>
        </tr>
      </ng-container>
    </tbody>
    <tfoot>
      <tr>
        <td><strong>Total Paid</strong></td>
        <td class="text-right"><strong>{{ receiptDetail.totalFee | number:'1.2-2' }}</strong></td>
      </tr>
    </tfoot>
  </table>

  <!-- Payment Details + Signature -->
  <section class="payment-signature-row">
    <div class="payment-section">
      <p><strong>Paid On:</strong> {{ receiptDetail.paymentDate | date: 'dd-MMM-yyyy hh:mm a' }}</p>
      <p><strong>Receipt Source:</strong> {{ receiptDetail.source || 'N/A' }} Patient</p>
    </div>

    <div class="signature">
      Authorized Signature
    </div>
  </section>

  <!-- Buttons -->
  <div class="action-row">
    <button class="btn btn-primary" (click)="print()">
      <i class="fas fa-print"></i> Print
    </button>
    <button class="btn btn-outline" (click)="close()">
      <i class="fas fa-times"></i> Close
    </button>
  </div>
</div>
